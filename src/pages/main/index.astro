---
import PickAlphabetSection from "@/components/PickAlphabetSection";
import Layout from "@/layouts/Layout.astro";
import AnswerSection from "@/components/AnswerSection";
import GameNavbar from "@/components/GameNavbar";

const alphabet = Array.from({ length: 26 }, (_, i) =>
  String.fromCharCode(97 + i),
);
---

<Layout title="Game">
  <main class="flex min-h-screen w-full flex-col">
    <GameNavbar isHPVisible={true} client:only="react" />

    <AnswerSection client:only="react" />

    <PickAlphabetSection options={alphabet} client:only="react" />
  </main>
</Layout>

<script>
  import { initKeyboardListener } from "@/utils/keyboard";

  let cleanup: (() => void) | undefined;

  // Initialize keyboard listener on every page load (including View Transitions navigation)
  document.addEventListener("astro:page-load", () => {
    cleanup = initKeyboardListener();
  });

  // Cleanup when navigating away from this page
  document.addEventListener("astro:before-preparation", () => {
    if (cleanup) {
      cleanup();
      cleanup = undefined;
    }
  });
</script>
